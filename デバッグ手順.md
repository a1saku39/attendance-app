# デバッグ手順

## 問題: 担当者印を押しても印が押されない

### 確認手順

1. **ブラウザの開発者ツールを開く**
   - キーボードの `F12` キーを押す
   - または、ブラウザで右クリック → 「検証」または「開発者ツール」を選択

2. **「Console」タブを選択**

3. **月次勤怠確認画面でデータを表示**
   - 社員コードと年月を入力
   - 「データを表示」ボタンをクリック

4. **コンソールに表示されるメッセージを確認**
   - 「取得したデータ:」というログが表示されるはずです
   - 「承認状態:」というログも表示されるはずです

5. **担当者印を押すボタンをクリック**
   - コンソールにエラーが表示されるか確認

### よくある問題と対処法

#### 問題1: 「取得したデータ」が表示されない
**原因**: Google Apps Scriptのデプロイが更新されていない

**対処法**:
1. Google Apps Scriptエディタを開く
2. 「デプロイ」→「デプロイを管理」
3. 右上の鉛筆アイコン（編集）をクリック
4. 「バージョン」のプルダウンから「新バージョン」を選択
5. 「デプロイ」をクリック

#### 問題2: 「approvalStatus is null」というエラー
**原因**: `getPersonalMonthlyData` 関数が承認状態を返していない

**対処法**:
1. `Code.gs` の `getPersonalMonthlyData` 関数を確認
2. 以下のコードが含まれているか確認:
```javascript
// 承認状態を取得
var approvalStatus = getApprovalStatus(employeeId, yearMonth);

return ContentService.createTextOutput(JSON.stringify({
  result: 'success',
  data: personalData,
  approvalStatus: approvalStatus  // ← これが必要
})).setMimeType(ContentService.MimeType.JSON);
```

#### 問題3: ボタンを押してもエラーが出ない
**原因**: リクエストは成功しているが、画面が更新されていない

**対処法**:
1. スプレッドシートの「月次承認記録_個人」シートを開く
2. データが追加されているか確認
3. 追加されている場合は、画面の再読み込み（F5キー）を試す

#### 問題4: 「操作者の情報がマスタに見つかりません」
**原因**: 社員マスタに該当する社員コードが登録されていない

**対処法**:
1. スプレッドシートの「社員マスタ」シートを開く
2. A列に入力した社員コードが存在するか確認
3. 存在しない場合は、行を追加して登録

### デバッグ用の確認ポイント

1. **GAS URLが設定されているか**
   - ブラウザのコンソールで `localStorage.getItem('attendance_gas_url')` を実行
   - URLが表示されるか確認

2. **社員マスタの構造**
   - A列: 社員コード
   - B列: 氏名
   - C列: 部署
   - D列: 承認対象部署（空欄でOK）
   - E列: 第1承認者
   - F列: 第2承認者（空欄でOK）
   - G列: メールアドレス
   - **H列: 印鑑** ← これが追加されているか確認

3. **「月次承認記録_個人」シートの確認**
   - このシートが自動作成されているか
   - ヘッダー行: 年月, 社員ID, 本人確認者, 本人確認日時, 承認者, 承認日時

---

## 次のステップ

上記の確認を行っても解決しない場合は、以下の情報を教えてください:

1. ブラウザのコンソールに表示されたエラーメッセージ（あれば）
2. 「取得したデータ:」のログ内容
3. 「承認状態:」のログ内容
4. スプレッドシートに「月次承認記録_個人」シートが作成されているか
5. 担当者印ボタンを押した後、何か反応があるか（確認ダイアログは表示されるか）
